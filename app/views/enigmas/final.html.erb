<main data-controller="wrapper" data-action="scroll->wrapper#hide">
  <div class="container flex-center">
    <div class="frame flex-center">
      <div class="corner-points flex-center flex-column">
        <div class="point"></div>
        <div class="point"></div>
        <div class="point"></div>
        <div class="point"></div>
        <h1>Nous y voilÃ  ! Le grand final !</h1>
        <p>On finit sur un petit puzzle, pas de stress, il nâ€™y a aucun piÃ¨ge !</p>
      </div>
    </div>
  </div>


  <div class="header-scroll" data-wrapper-target="scroll">
    <p class="scroll-items">SCROLL</p>
    <p class="scroll-items">|</p>
  </div>


  <div class="puzzle margin-auto">

    <div class="tiles margin-auto flex-center"
      data-controller="sortable-puzzle" data-sortable-puzzle-target="tiles"
      data-sortable-puzzle-sort-url-value="<%= sort_enigma_tiles_path(@enigma) %>"
      data-action="mouseleave->wrapper#reveal">
      <h1 class="contact-message hidden" data-sortable-puzzle-target="contactMessage" data-wrapper-target="contactMessage"><a href="mailto:arnaud.rigourd@hotmail.fr">Contacte moi !</a></h1>

      <% @tiles.each do |t| %>
        <div class="tile" data-sortable-puzzle-target="tile" data-tile-id=<%= t.id %> >
          <%= image_tag t.image, alt:"puzzle"%>
        </div>
      <% end %>

    </div>

    <div class="header-scroll hidden" data-wrapper-target="scroll">
    <p class="scroll-items">SCROLL</p>
    <p class="scroll-items">|</p>
  </div>
  </div>

  <div class="reveal hidden" data-wrapper-target="siteInfo">
    <h3 class="reveal__title" data-action="click->wrapper#show">Pour les plus curieux</h3>
    <div class="reveal__content" data-wrapper-target="revealContent">
      <div class="reveal__content--text">
        <p>Si tu lis ceci, c'est que tu as passÃ© toutes les Ã©preuves. FÃ©licitation ! Tu viens de dÃ©couvrir FindHint, un site d'Ã©nigmes crÃ©Ã© par mes soins, Arnaud Rigourd, dÃ©veloppeur full stack.</p>

        <p>Tu l'auras remarquÃ©, la font a changÃ©. Je suis d'accord, Ã§a fait un petit choc, mais pour des questions de lisibilitÃ©, cette font sera plus adaptÃ©e. Tes yeux me remercieront ğŸ˜‰</p>

        <p>Ci-dessous, je t'explique les points clÃ©s de chaque Ã©preuve afin de te permettre d'en comprendre les mÃ©canismes.</p>

        <p>Sur ce, je n'ai plus qu'Ã  te souhaiter bonne lecture !</p>
      </div>
    </div>

    <h3 class="reveal__title" data-action="click->wrapper#show">CrÃ©ation et conception des Ã©nigmes</h3>
    <div class="reveal__content" data-wrapper-target="revealContent">
      <%= image_tag "figma.webp", alt:"figma", data: {action:"click->wrapper#zoom"} %>
      <div class="reveal__content--text">
        <p>Comme pour chaque projet, les fondations du site sont nÃ©es sur notion. Jâ€™ai commencÃ© par poser toutes les idÃ©es sous forme de bullet point : dâ€™un cotÃ© les idÃ©es crÃ©atives (relatives aux Ã©nigmes), et de lâ€™autre les hard skills nÃ©cessaires pour mettre en place chacune des Ã©nigmes.</p>

        <p>Une fois les idÃ©es rÃ©unies, place au visuel, place Ã  <em>Figma</em>. On peut voir sur lâ€™image ci-contre que le rendu est assez fidÃ¨le Ã  la maquette de dÃ©part, Ã  2-3 exceptions prÃ¨s. La charte graphique Ã©tant relativement simple, cette Ã©tape a Ã©tÃ© assez rapide. Passons au schÃ©mas de DB.</p>
      </div>
    </div>

    <h3 class="reveal__title" data-action="click->wrapper#show">Le schema de DB</h3>
    <div class="reveal__content" data-wrapper-target="revealContent">
      <%= image_tag "db.webp", alt:"database", data: {action:"click->wrapper#zoom"} %>
      <div class="reveal__content--text">
        <p>En premier lieu, je suis parti sur une DB trÃ¨s simple avec une seule table que jâ€™ai nommÃ© "Enigmas" par souci de comprÃ©hension. En effet, sachant que jâ€™allais utiliser lâ€™URL dans la 3Ã¨me Ã©nigmes, je ne souhaitais pas avoir des termes peu cohÃ©rents tels que "pages" ou "answers", car oui, cette table aurait du sâ€™appeler "answers" pour stocker les rÃ©ponses des utilisateurs.</p>

        <p>Rapidement, je me rends compte quâ€™une seule table de suffira pas, notamment si plusieurs utilisateurs viennent visiter le site simultanÃ©ment. La principale problÃ©matique qui se posait alors Ã©tait la suivante : comment offrir Ã  chaque utilisateur un parcours unique sans avoir besoin de se connecter (la crÃ©ation dâ€™un compte user est un rÃ©el frein et dÃ©tÃ©riore lâ€™expÃ©rience utilisateur sur ce type de site). La solution Ã  donc Ã©tÃ© de revoir le schema de DB, en y ajoutant une table "answers" ainsi quâ€™une table "chats" pour, respectivement, la premiÃ¨re et troisiÃ¨me Ã©nigme. Ces deux tables Ã©tant liÃ©es Ã  la table "enigmas", chaque user pouvait dÃ©sormais bÃ©nÃ©ficier de leur propre parcours sans interfÃ©rer avec les rÃ©ponses des autres. Pour finir, afin de les faire entrer dans leur propre table "enigmas", un simple clique sur le bouton "Oui" sur la landing page permet de crÃ©er une instance de "enigmas". Et sâ€™ils cliquent sur "Non" â€¦ Surprise ! ğŸ˜‰</p>
      </div>
    </div>

    <h3 class="reveal__title" data-action="click->wrapper#show">1Ã¨re Ã©nigme : Le mot de passe</h3>
    <div class="reveal__content" data-wrapper-target="revealContent">
      <%= image_tag "perspective.webp", alt:"perspective api", data: {action:"click->wrapper#zoom"} %>
      <div class="reveal__content--text">
        <p>Vous avez peut-Ãªtre passÃ© cette Ã©preuve sans trop dâ€™encombre, ou mÃªme sans vraiment savoir comment vous avez rÃ©ussi ? Câ€™est normal, mÃªme si ce nâ€™Ã©tait pas vraiment l'objectif. Je mâ€™explique : il ya deux faÃ§ons de passer cette Ã©preuve. La premiÃ¨re consiste Ã  demander poliment, en utilisant des termes dÃ©terminÃ©s dans un array de rÃ©ponses acceptÃ©es : ["please", "stp", 'svp', "s'il te plait", "s'il te plaÃ®t", "s il te plait", "s il te plaÃ®t", "s'il-te-plait", "s'il-te-plaÃ®t"]</p>

        <p>La deuxiÃ¨me maniÃ¨re de passer cette Ã©preuve est la plus intÃ©ressante. En effet, si lâ€™utilisateur ne voit pas lâ€™indice, il est indiquÃ© quâ€™il peut faire un compliment sincÃ¨re. Mais comment Ã§a marche exactement ? Câ€™est lâ€™API de Google "Perspective" qui permet de traiter les input utilisateur et leur donner un score de "ToxicitÃ©". Selon le score, vous pouviez passer Ã  lâ€™Ã©tape suivante ou non. LÃ  oÃ¹ lâ€™algorithme nâ€™est pas optimisÃ© pour cette Ã©preuve, câ€™est quâ€™il a Ã©tÃ© conÃ§u pour dÃ©tecter les commentaires toxiques des internautes. Autrement dit, il fait difficilement la diffÃ©rence entre un compliment et un commentaire neutre. Câ€™est la principale raison pour laquelle tu nâ€™as peut-Ãªtre pas compris comment tu es passÃ© Ã  lâ€™Ã©preuve suivante. MalgrÃ© cela, je trouvais lâ€™utilisation dâ€™une telle API intÃ©ressante.</p>
      </div>
    </div>

    <h3 class="reveal__title" data-action="click->wrapper#show">2Ã¨me Ã©nigme : La mise en Ã©vidence</h3>
    <div class="reveal__content" data-wrapper-target="revealContent">
      <%= image_tag "evidence.webp", alt:"evidence", data: {action:"click->wrapper#zoom"} %>
      <div class="reveal__content--text">
        <p>Jâ€™ai dÃ©couvert cet effet sur <a href="https://www.akufen.ca/fr/studio" target="_blank">https://www.akufen.ca/fr/studio</a>, et souhaitais le dupliquer. Cependant, leur faÃ§on de faire ne me convenait pas tout Ã  fait par rapport Ã  lâ€™utilisation que je souhaitais en faire. Jâ€™ai ainsi pu recrÃ©er cet effet dâ€™une nouvelle maniÃ¨re. Un tour dans la doc de Mozilla mâ€™a permit de finaliser lâ€™effet de surlignage. Pour plus dâ€™information, nâ€™hÃ©sitez pas Ã  faire un tour dans le code source sur mon GitHub <a href="https://github.com/Arnaud-Rigourd" target="_blank">(https://github.com/Arnaud-Rigourd)</a>.</p>
      </div>
    </div>

    <h3 class="reveal__title" data-action="click->wrapper#show">3Ã¨me Ã©nigme : Tout ou rien</h3>
    <div class="reveal__content" data-wrapper-target="revealContent">
      <%= image_tag "chat.webp", alt:"chat", data: {action:"click->wrapper#zoom"} %>
      <div class="reveal__content--text">
        <p>Dans cette Ã©preuve, les citations sont uniquement un moyen dâ€™intÃ©grer un peu de parallax au sein du site. Elles nâ€™ont aucun rapport avec l'Ã©preuve, mais lâ€™intÃ©gration dâ€™information inutile reste pertinent dans un site dâ€™Ã©nigmes.</p>

        <p>Nous arrivons dÃ©sormais au Chat : Place Ã  lâ€™AJAX !
        On sâ€™assure dâ€™abord que le back fonctionne, puis on y ajoute de lâ€™AJAX pour amÃ©liorer l'expÃ©rience utilisateur.</p>

        <p>En ce qui concerne le back, 3 scenari ont Ã©tÃ© pris en compte :</p>
        <ol>
          <li><em class="answers-list">La bonne rÃ©ponse :</em> "rien" avec une petite regex et quelques mÃ©thodes ruby histoire de ne pas trop pÃ©naliser le user : downcase.gsub(/[\s\W]/, â€˜â€™). Par contre, il ne fallait pas que "jâ€™en sais rien" permette de passer, raison pour laquelle je nâ€™ai pas optÃ© pour un .include? !</li>
          <li><em class="answers-list">Une mauvaise rÃ©ponse</em> qui aurait pu Ãªtre bonne. Je mâ€™explique : les enfants, les humains, la vie etcâ€¦ sont des rÃ©ponses intÃ©ressantes dans la rÃ©flexion. Pour cette raison, un message spÃ©cifique leur est destinÃ©.</li>
          <li><em class="answers-list">Toutes les autres rÃ©ponses.</em> Un panel de 5 rÃ©ponses alÃ©atoires est prÃ©vu Ã  cet effet, 2 dâ€™entre elles sont neutres, 2 donnent un indice, et une indique de chercher la rÃ©ponse sur google afin que le user ne reste pas indÃ©finiment bloquÃ© (ce nâ€™est pas le but du site).</li>
        </ol>

        <p>Enfin, tout fonctionne, mais chaque rÃ©ponse rafraÃ®chit la pageâ€¦ On ajoute un peu dâ€™AJAX avec Jbuilder, on parsÃ¨me de settimeout pour amÃ©liorer lâ€™UX (cela ajoute un lÃ©ger dÃ©lai de rÃ©ponse de la part du bot), et le tour est jouÃ© !</p>
      </div>
    </div>

    <h3 class="reveal__title" data-action="click->wrapper#show">4Ã¨me Ã©nigme : Le grand final !</h3>
    <div class="reveal__content" data-wrapper-target="revealContent">
      <%= image_tag "code.webp", alt:"code", data: {action:"click->wrapper#zoom"} %>
      <div class="reveal__content--text">
        <p>Pour lâ€™Ã©preuve finale, je ne voulais pas quelque chose de compliquÃ©, car la prÃ©cÃ©dente Ã©preuve lâ€™Ã©tait dÃ©jÃ  bien assez. Câ€™est pour cette raison que jâ€™ai mis en place un simple puzzle. Lâ€™objectif Ã©tait multiple :</p>

        <ul>
          <li>Finir sur une note lÃ©gÃ¨re</li>
          <li>Retrouver Ã  nouveau de lâ€™AJAX afin de rendre l'exercice intÃ©ressant dâ€™un point de vu dÃ©veloppeur</li>
          <li>Surprendre lâ€™utilisateur avec une photo de moi Ã  la fin, pour une prise de contact ğŸ˜ Car oui, ce site a Ã©tÃ© conÃ§u afin de montrer, via une interface ludique, mes capacitÃ©s en tant que dÃ©velopeur full stack sur RoR.</li>
        </ul>

        <p>La principale difficultÃ© rÃ©sidait dans la maniÃ¨re de dÃ©tecter lâ€™ordre du puzzle et ainsi vÃ©rifier le bon ordre des tuiles. Voici la mÃ©thode que jâ€™ai utilisÃ© : (attention, il faut Ãªtre concentrÃ©)</p>

        <p>Dans un premier temps, jâ€™ai dÃ©clarer un array avec la "combinaison gagnante" : rightOrder = [-5,  7,  -6, 5,  -7, 4,  -1, 2]
        Dans cet array, chaque index correspond Ã  la soustraction de lâ€™index[n] - index[n + 1]. n correspond Ã  lâ€™ID dâ€™une tuile. Dans ce cas, on se demande "pourquoi ne pas utiliser directement lâ€™ID" ? Jâ€™aurais aimÃ© indiquer lâ€™ordre des tuiles via leur ID unique en DB, cependant, pour chaque user, lâ€™ID des tuiles est effectivement unique. En dâ€™autres termes, le user "x" aura des tuiles avec les ID 1, 2, 3..9, et le user "y" aura des tuiles avec les ID 10, 11, 12..18. Cependant, lâ€™ordre reste le mÃªme et les ID sont des multiples de 9 puisque le puzzle est composÃ© de 9 tuiles. Ainsi, lâ€™Ã©cart entre les ID ne change pas.</p>
        <p>Parti de ce constat, je dÃ©clare dÃ©sormais un nouveau tableau chargÃ© de stocker la position de chaque tuile au "mouseup" et push le rÃ©sultat de index[n] - index[n+1] dans un nouvel array nommÃ© "currentOrder".</p>

        <p>Jâ€™ai donc 2 tableaux : rightOrder qui fait office de combinaison gagnante, et currentOrder, que lâ€™on va pouvoir comparer Ã  rightOrder pour vÃ©rifier si le user a gagnÃ© ou non.</p>

        <p>Comment comparer les tableaux ? Je suis parti sur une simple soustraction des index. Si le rÃ©sultat est 0, alors les tableaux sont identiques.</p>

        <p>Dans un premier temps, jâ€™ai stockÃ© toutes les soustractions dans un nouvel array. Lâ€™idÃ©e Ã©tant que, si les combinaisons correspondaient, la somme du nouveau tableau (.sum) se porterait Ã  0. Cependant, certaines combinaisons telles que [0, 0, 0, +2, +8, -5, -5, 0] donnaient Ã©galement 0, alors que lâ€™ordre nâ€™Ã©tait pas respectÃ©. Il fallait donc ajouter une condition pour Ãªtre certain que toutes les soustractions vÃ©rifiaient bien un score de 0. Câ€™est ainsi quâ€™est apparue la variable "rightCurrentOrderSum" chargÃ© dâ€™ajouter +1 si le score est diffÃ©rent de 0, et +0 si le score est Ã©gal Ã  0. Ainsi, Ã  la fin de lâ€™itÃ©ration, si le score final est Ã©gal Ã  0, cela signifie que les tuiles sont dans le bon ordre. ğŸ‰</p>
      </div>
    </div>

    <h3 class="reveal__title" data-action="click->wrapper#show">DerniÃ¨re Ã©tape : Les tests utilisateurs avec Hotjar</h3>
    <div class="reveal__content" data-wrapper-target="revealContent">
      <div class="reveal__content--text">
        <p>La derniÃ¨re Ã©tape et pas des moindres : les tests utilisateurs. Afin de vÃ©rifier le parcours utilisateur ainsi que le niveau de difficultÃ© des Ã©nigmes, jâ€™ai testÃ© le site avec des proches, en utilisant Hotjar, une solution permettant de visualiser le comportement du user, les "hot points" de chaque page, et ainsi vÃ©rifier la bonne ergonomie du site. GrÃ¢ce Ã  ces tests, jâ€™ai pu modifier quelques Ã©lÃ©ments afin dâ€™offrir lâ€™expÃ©rience que tu viens de vivre.</p>

        <p>D'ailleurs, si tu as remarquÃ© des bugs ou des incohÃ©rences, n'hÃ©sites pas Ã  m'en faire part ! (Mes coordonnÃ©es sont juste en dessous ğŸ‘‡)</p>
      </div>
    </div>

    <h3 class="reveal__title" data-action="click->wrapper#show">CoordonnÃ©es</h3>
    <div class="reveal__content" data-wrapper-target="revealContent">
      <div class="reveal__content--text">
        <p>Si lâ€™expÃ©rience tâ€™a plu et que tu souhaites en savoir plus sur mon travail, nâ€™hÃ©sites pas Ã  me contacter, ou faire un tour sur :</p>
        <ul>
          <li>Mon Portfolio : <a href="https://www.arnaud-rigourd.com/" target="_blank">https://www.arnaud-rigourd.com/</a></li>
          <li>Mon GitHub : <a href="https://github.com/Arnaud-Rigourd" target="_blank">https://github.com/Arnaud-Rigourd</a></li>
          <li>Mon Linkedin : <a href="https://www.linkedin.com/in/arnaudrigourd/" target="_blank">https://www.linkedin.com/in/arnaudrigourd/</a></li>
          <li>Mon tÃ©lÃ©phone : 06 88 61 24 83</li>
          <li>Mon Mail : <a href="mailto:arnaud.rigourd@hotmail.fr" target="_blank">arnaud.rigourd@hotmail.fr</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container hidden" data-wrapper-target="thanksFrame">
    <div class="frame flex-center">
      <div class="corner-points flex-center flex-column">
        <div class="point"></div>
        <div class="point"></div>
        <div class="point"></div>
        <div class="point"></div>
        <h1><a class="thanks-link" href="https://www.arnaud-rigourd.com/" target="_blank">Merci et Ã  bientÃ´t !</a></h1>
      </div>
    </div>
  </div>

</main>
